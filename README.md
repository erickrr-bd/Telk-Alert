# Telk-Alert v3.0

Author: Erick Rodr√≠guez erickrr.tbd93@gmail.com

License: GPLv3

Telk-Alert is an application developed in Python, which allows alerts based on searches made in ElasticSearch. Developed mainly for use in information security issues, for monitoring activities and timely alerting.

# Applications
## Telk-Alert
Application that allows data searches in ElasticSearch using defined rules, and when events are found, it allows sending alerts to the user with details about the event found.

Characteristics:
- The connection with ElasticSearch can be done through HTTPS and HTTP authentication (It must be configured in ElasticSearch).
- It has been tested to work with the indices generated by Auditbeat, Winlogbeat and Filebeat.
- The search in ElasticSearch is done through Query String.
- The sending of alerts can be sent to a Telegram channel or to one or more email addresses or both.
- The searches are programmed to be carried out every certain configurable time.
- Create and write everything that happens in the application in an index in ElasticSearch.
- For security reasons, a user is created for the Telk-Alert service to work with.
- Sending alerts restricted by a certain number of events by hostname (For example, for failed user logins).
- Sending alerts restricted by a certain number of fields, that is, it does not send all the information about the event, but only sends the fields that were configured in the alert rule.
- In case of finding more than one event, the alert can be configured to send only one message and the total number of events or one message for each event found.
- Parse data that will be sent in the alert to give you a better view.

## Telk-Alert-Tool
Telk-Alert graphical tool that allows the user to define the configuration and alert rules that will be used for the operation of the application. These data are saved in files with the extension yaml.

Characteristics:
- Allows you to create and modify the Telk-Alert connection settings.
- Allows you to create, modify and delete alert rules.
- Encrypts sensitive data such as passwords so that they are not stored in plain text.
- Allows you to start, restart, stop and get the status of the Telk-Alert service.
- Allows you to create and modify the Telk-Alert-Agent configuration.
- Allows you to start, restart, stop and get the status of the Telk-Alert-Agent service.

## Telk-Alert-Agent
Telk-Alert auxiliary tool that allows to validate the status of the Telk-Alert service and send an alert.

Characteristics:
- Validate the Telk-Alert service at two configurable hours of the day.
- Send the status of the Telk-Alert service to a Telegram channel.

# Requirements
- CentOS 8 (So far it has only been tested in this version)
- ElasticSearch 7.x 
- Python 3.6
- Python Libraries
  - elasticsearch-dsl
  - requests
  - pycurl
  - pythondialog
  - pycryptodome
  - pyyaml

# Installation
Run the executable installer_telk_alert.sh, which is in charge of installing the packages and libraries necessary for the operation of Telk-Alert (these can also be installed manually).It is also responsible for copying and creating the necessary files and directories, creating a user and a group and also the services for the operation of the application. Run with a user with administrator permissions.

# Commercial Support
![Tekium](https://github.com/unmanarc/uAuditAnalyzer2/blob/master/art/tekium_slogo.jpeg)

Tekium is a cybersecurity company specialized in red team and blue team activities based in Mexico, it has clients in the financial, telecom and retail sectors.

Tekium is an active sponsor of the project, and provides commercial support in the case you need it.

For integration with other platforms such as the Elastic stack, SIEMs, managed security providers in-house solutions, or for any other requests for extending current functionality that you wish to see included in future versions, please contact us: info at tekium.mx

For more information, go to: https://www.tekium.mx/
